# ЗАДАЧА-015: Исправление Парсера Заголовков Markdown

## Метаданные Задачи
- **ID:** TASK-015
- **Создана:** 2025-08-03_11-49
- **Статус:** ✅ ЗАВЕРШЕНО - QA Пройдено
- **Приоритет:** Высокий
- **Тип:** Исправление Бага

## Описание Проблемы
Markdown парсер неправильно обрабатывает пронумерованные заголовки (например, `## 1. Заголовок Раздела`), конвертируя их в элементы упорядоченного списка (`<ol><li>...</li></ol>`) вместо правильных тегов заголовков (`<h3>...</h3>`).

## Спецификации Пользователя
- **Вход:** `## 1. Знакомство с участниками` в файле class001.structured.md
- **Текущий Некорректный Вывод:**
  ```json
  {
    "tag": "ol",
    "children": [
      {
        "tag": "li",
        "children": ["Знакомство с участниками"]
      }
    ]
  }
  ```
- **Ожидаемый Корректный Вывод:**
  ```json
  {
    "tag": "h3",
    "children": ["1. Знакомство с участниками"]
  }
  ```

## Основная Причина
В файле `src/markdownConverter.ts`, в функции `convertMarkdownToTelegraphNodes`, логическая проверка элементов списка (`listItemMatch`) выполняется *перед* проверкой заголовков (`headingMatch`). Регулярное выражение для упорядоченных списков (`/(\d+)\.\s+(.*)/`) достаточно широкое, чтобы соответствовать пронумерованному заголовку.

## Техническое Решение
1. **Переупорядочить условные блоки:** Переместить обработку заголовков перед обработкой списков
2. **Улучшить regex:** Сделать регулярное выражение списков более специфичным
3. **Добавить тесты:** Создать unit тест для валидации исправления

## Файлы для Изменения
- `src/markdownConverter.ts` - основное исправление логики парсинга
- `src/markdownConverter.test.ts` - добавление тестов

## Критерии Приемки
1. ✅ Линия Markdown `## 1. Знакомство с участниками` должна корректно парситься в структуру JSON с тегом `h3`
2. ✅ Стандартные элементы упорядоченного списка должны продолжать корректно парситься как `ol > li`
3. ✅ Стандартные элементы неупорядоченного списка должны продолжать корректно парситься как `ul > li`
4. ✅ Все существующие тесты должны продолжать проходить
5. ✅ Новый unit тест должен валидировать исправление

## Прогресс
- [x] Анализ проблемы завершен
- [x] Техническая спецификация готова
- [x] Реализация изменений в src/markdownConverter.ts
- [x] Добавление unit тестов (8 новых тестов)
- [x] Валидация всех тестов (316/316 проходят)
- [x] Проверка регрессии (отсутствует)
- [x] QA тестирование завершено
- [x] Интеграционное тестирование CLI

## Трассируемость
- **Пользовательская Спецификация:** Исправить парсинг пронумерованных заголовков
- **Техническое Решение:** Переупорядочить условную логику в convertMarkdownToTelegraphNodes
- **Реализация:** Модификации в src/markdownConverter.ts и тесты