# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–¶–µ–ª—å:** –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (`publish`) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –¥–ª—è –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–µ–π (—è–∫–æ—Ä–µ–π –∏ —Å—Ç—Ä–∞–Ω–∏—Ü) –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–Ω—Ç–µ–Ω—Ç–µ.

## 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

**–ó–∞–¥–∞—á–∞:** –õ—é–±—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –≤ –∫–æ–º–∞–Ω–¥—É `publish` –∏ –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª `.telegraph-publisher-config.json`.

### –®–∞–≥ 1.1: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥—ã `publish`

**–§–∞–π–ª –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `src/cli/EnhancedCommands.ts`
**–ú–µ—Ç–æ–¥ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `handleUnifiedPublishCommand(options: any)`

**–õ–æ–≥–∏–∫–∞:**
–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `PublicationWorkflowManager` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º:

1.  **–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:** –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ —Ñ–∞–π–ª–∞ `.telegraph-publisher-config.json` —Å –ø–æ–º–æ—â—å—é `ConfigManager.getMetadataConfig()`.
2.  **–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Ç–æ–ª—å–∫–æ —Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ `options`, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.
3.  **–û–±—ä–µ–¥–∏–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:** –°–æ–∑–¥–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –æ–±—ä–µ–¥–∏–Ω–∏–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∏–º–µ—é—Ç –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç.
4.  **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:** –í—ã–∑–≤–∞—Ç—å `ConfigManager.updateMetadataConfig()` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ —Ñ–∞–π–ª.
5.  **–ü–µ—Ä–µ–¥–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:** –ü–µ—Ä–µ–¥–∞—Ç—å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `PublicationWorkflowManager`, —á—Ç–æ–±—ã —Ç–µ–∫—É—â–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø—Å–µ–≤–¥–æ–∫–æ–¥ –¥–ª—è `handleUnifiedPublishCommand`):**

```typescript
// src/cli/EnhancedCommands.ts -> handleUnifiedPublishCommand

// ... (–Ω–∞—á–∞–ª–æ –º–µ—Ç–æ–¥–∞)

const fileDirectory = options.file ? dirname(resolve(options.file)) : process.cwd();

// 1. –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
const existingConfig = ConfigManager.getMetadataConfig(fileDirectory);

// 2. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∏–∑ –æ–ø—Ü–∏–π CLI
const updatesFromCli: Partial<MetadataConfig> = {};
if (options.author) {
    updatesFromCli.defaultUsername = options.author;
}
// –î–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –æ–ø—Ü–∏–∏: tocTitle, –∏ —Ç.–¥.

// 3. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π (CLI –æ–ø—Ü–∏–∏ –∏–º–µ—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
const finalConfig: MetadataConfig = {
    ...existingConfig,
    ...updatesFromCli
};

// 4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
ConfigManager.updateMetadataConfig(fileDirectory, finalConfig);

// –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–∫–µ–Ω–∞ (—Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∞)
const accessToken = options.token || ConfigManager.loadAccessToken(fileDirectory);
if (options.token) {
    ConfigManager.saveAccessToken(fileDirectory, options.token);
}

if (!accessToken) {
    throw new Error("Access token is required...");
}

// 5. –ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ workflow
const workflowManager = new PublicationWorkflowManager(finalConfig, accessToken);

// ... (–¥–∞–ª—å–Ω–µ–π—à–∞—è –ª–æ–≥–∏–∫–∞ –º–µ—Ç–æ–¥–∞)
```

### –®–∞–≥ 1.2: –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–§–∞–π–ª –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `src/config/ConfigManager.ts`
**–ú–µ—Ç–æ–¥ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `updateMetadataConfig(directory: string, metadataConfig: Partial<MetadataConfig>)`

**–õ–æ–≥–∏–∫–∞:**
–ú–µ—Ç–æ–¥ `saveConfig`, –≤—ã–∑—ã–≤–∞–µ–º—ã–π –∏–∑ `updateMetadataConfig`, —É–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏ –Ω–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç **–≤—Å–µ** –ø–æ–ª—è, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ. –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `saveConfig` —É–∂–µ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ: `const mergedConfig = { ...existingConfig, ...config };`. –ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ `ConfigManager` –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, –Ω–æ –≤–∞–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤ `EnhancedCommands`.

## 2. –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–µ –∏ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—ç—à–µ–º

**–ó–∞–¥–∞—á–∞:** –ö—ç—à–∏ (`.telegraph-anchors-cache.json` –∏ `.telegraph-pages-cache.json`) –¥–æ–ª–∂–Ω—ã –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ `publish`. –û–Ω–∏ –¥–æ–ª–∂–Ω—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è, –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç, –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ–∞–π–ª–∞.

### –®–∞–≥ 2.1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ `contentHash` –≤ –∫—ç—à —Å—Ç—Ä–∞–Ω–∏—Ü

**–§–∞–π–ª –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `src/types/metadata.ts`
**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `PublishedPageInfo`

**–õ–æ–≥–∏–∫–∞:**
–î–ª—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–∞—Ö. –î–æ–±–∞–≤–∏–º –ø–æ–ª–µ `contentHash` –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `PublishedPageInfo`.

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:**

```typescript
// src/types/metadata.ts

export interface PublishedPageInfo {
  // ... (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è)
  views?: number;
  localFilePath?: string;
  contentHash?: string; // <-- –î–û–ë–ê–í–ò–¢–¨ –≠–¢–û –ü–û–õ–ï
}
```

### –®–∞–≥ 2.2: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –¥–ª—è –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—ç—à–µ–º

**–§–∞–π–ª –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `src/workflow/PublicationWorkflowManager.ts`
**–ú–µ—Ç–æ–¥ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `publish(targetPath: string, options: any)`

**–õ–æ–≥–∏–∫–∞:**
–í —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ –º–µ—Ç–æ–¥–∞ `publish` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—ç—à–µ–π –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã.

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø—Å–µ–≤–¥–æ–∫–æ–¥ –¥–ª—è `publish`):**

```typescript
// src/workflow/PublicationWorkflowManager.ts -> publish

public async publish(targetPath: string, options: any): Promise<void> {
    // ... (–ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è filesToProcess)

    // –ù–û–í–´–ô –®–ê–ì: –ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–µ–π
    await this.initializeAndValidateCaches(filesToProcess);

    // ... (–¥–∞–ª—å–Ω–µ–π—à–∞—è –ª–æ–≥–∏–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—Å—ã–ª–æ–∫ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏)
}
```

### –®–∞–≥ 2.3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è `initializeAndValidateCaches`

**–§–∞–π–ª –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `src/workflow/PublicationWorkflowManager.ts`
**–ù–æ–≤—ã–π –º–µ—Ç–æ–¥:** `initializeAndValidateCaches(filesToProcess: string[])`

**–õ–æ–≥–∏–∫–∞:**
–≠—Ç–æ—Ç –Ω–æ–≤—ã–π –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∏—Ç–µ—Ä–∞—Ü–∏—é –ø–æ –≤—Å–µ–º —Ñ–∞–π–ª–∞–º –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ:

1.  **–ö—ç—à —è–∫–æ—Ä–µ–π (`AnchorCacheManager`):**
    *   –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –∏ –≤—ã—á–∏—Å–ª–∏—Ç—å –µ–≥–æ `contentHash`.
    *   –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `AnchorCacheManager`, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –ª–∏ –∫—ç—à –¥–ª—è —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ —Å —Ç–µ–∫—É—â–∏–º —Ö—ç—à–µ–º.
    *   –ï—Å–ª–∏ –∫—ç—à –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω (–∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç), –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –µ–≥–æ: –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª, –∏–∑–≤–ª–µ—á—å —è–∫–æ—Ä—è –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫—ç—à. –≠—Ç–æ "–ø—Ä–æ–≥—Ä–µ–µ—Ç" –∫—ç—à –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ `LinkVerifier` –µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç.
2.  **–ö—ç—à —Å—Ç—Ä–∞–Ω–∏—Ü (`PagesCacheManager`):**
    *   –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `PagesCacheManager` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω.
    *   –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —Ñ–∞–π–ª –≤ –∫—ç—à–µ —Å—Ç—Ä–∞–Ω–∏—Ü.
    *   –ï—Å–ª–∏ —Ñ–∞–π–ª –µ—Å—Ç—å –≤ –∫—ç—à–µ, —Å—Ä–∞–≤–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π `contentHash` —Ñ–∞–π–ª–∞ —Å `contentHash` –∏–∑ –∫—ç—à–∞.
    *   *–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –õ–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤ `EnhancedTelegraphPublisher`, –Ω–æ —Ç–µ–ø–µ—Ä—å –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –∏ `contentHash`.

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø—Å–µ–≤–¥–æ–∫–æ–¥):**

```typescript
// src/workflow/PublicationWorkflowManager.ts

private async initializeAndValidateCaches(filesToProcess: string[]): Promise<void> {
    ProgressIndicator.showStatus("üîé Initializing and validating caches...", "info");

    // –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –∫—ç—à–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    const projectRoot = this.pathResolver.findProjectRoot(filesToProcess[0] || process.cwd());
    this.linkVerifier = new LinkVerifier(this.pathResolver, projectRoot);
    // this.publisher.initializeCacheManager(filesToProcess[0]); // –õ–æ–≥–∏–∫–∞ —É–∂–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞ –º–µ—Å—Ç–µ

    for (const filePath of filesToProcess) {
        try {
            const content = readFileSync(filePath, 'utf-8');
            const contentWithoutMetadata = MetadataManager.removeMetadata(content);
            const currentHash = ContentProcessor.calculateContentHash(contentWithoutMetadata);

            // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ —è–∫–æ—Ä–µ–π
            // LinkVerifier —Å–¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–æ—Å—Ç—É–ø–µ,
            // –ø–æ—ç—Ç–æ–º—É —è–≤–Ω—ã–π –≤—ã–∑–æ–≤ –∑–¥–µ—Å—å –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω, –Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.
            // this.linkVerifier.getAnchorsForFile(filePath); // –≠—Ç–æ –≤—ã–∑–æ–≤–µ—Ç –ª–æ–≥–∏–∫—É –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

            // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞ —Å—Ç—Ä–∞–Ω–∏—Ü (–ª–æ–≥–∏–∫–∞ –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, —Ç.–∫. –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏)
            const pageInfo = this.publisher.getCacheManager()?.getPageByLocalPath(filePath);
            if (pageInfo && pageInfo.contentHash !== currentHash) {
                ProgressIndicator.showStatus(`‚ÑπÔ∏è  Content of '${basename(filePath)}' has changed, will be republished.`, "info");
            }

        } catch (error) {
            ProgressIndicator.showStatus(`‚ö†Ô∏è Could not process cache for ${basename(filePath)}`, "warning");
        }
    }

    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫—ç—à —è–∫–æ—Ä–µ–π –ø–æ—Å–ª–µ –≤—Å–µ—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
    this.linkVerifier.getAnchorCacheManager()?.saveCache();
}
```

### –®–∞–≥ 2.4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `contentHash` –≤ –∫—ç—à–µ —Å—Ç—Ä–∞–Ω–∏—Ü –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

**–§–∞–π–ª –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `src/publisher/EnhancedTelegraphPublisher.ts`
**–ú–µ—Ç–æ–¥—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `publishWithMetadata` –∏ `editWithMetadata`

**–õ–æ–≥–∏–∫–∞:**
–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ç–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å `contentHash` –≤ `PagesCacheManager`.

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `publishWithMetadata`:**

```typescript
// src/publisher/EnhancedTelegraphPublisher.ts -> publishWithMetadata

// ... (–ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏—è metadata)
const metadata = MetadataManager.createMetadata(
    page.url,
    page.path,
    username,
    filePath,
    contentHash, // <-- contentHash —É–∂–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è
    metadataTitle
);

// ... (–ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª)

// –û–±–Ω–æ–≤–ª—è–µ–º addToCache –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ contentHash
this.addToCache(filePath, page.url, page.path, metadataTitle, username, contentHash);
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `editWithMetadata`:**

```typescript
// src/publisher/EnhancedTelegraphPublisher.ts -> editWithMetadata

// ... (–ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
const updatedContentHash = this.calculateContentHash(processed.contentWithoutMetadata);

const updatedMetadata: FileMetadata = {
    ...existingMetadata,
    publishedAt: new Date().toISOString(),
    title: metadataTitle,
    contentHash: updatedContentHash // <-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ö—ç—à
};

// ... (–ø–æ—Å–ª–µ –∑–∞–ø–∏—Å–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª)

if (this.cacheManager) {
    this.cacheManager.updatePage(page.url, {
        title: metadataTitle,
        authorName: username,
        lastUpdated: new Date().toISOString(),
        contentHash: updatedContentHash // <-- –î–û–ë–ê–í–ò–¢–¨ –û–ë–ù–û–í–õ–ï–ù–ò–ï –•–≠–®–ê –í –ö–≠–®
    });
}
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `addToCache` –∏ `PagesCacheManager`:**
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—É –º–µ—Ç–æ–¥–∞ `addToCache` –∏ `addPage`, —á—Ç–æ–±—ã –æ–Ω–∏ –ø—Ä–∏–Ω–∏–º–∞–ª–∏ `contentHash`.

## –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Workflow Summary)

1.  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç `telegraph-publisher publish [path] --author "New Author"`.
2.  **`EnhancedCommands`:**
    *   –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `.telegraph-publisher-config.json`.
    *   –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –µ–≥–æ —Å `defaultUsername: "New Author"`.
    *   –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–≤—ã–π, –ø–æ–ª–Ω—ã–π `.telegraph-publisher-config.json`.
    *   –°–æ–∑–¥–∞–µ—Ç `PublicationWorkflowManager` —Å —ç—Ç–æ–π –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π.
3.  **`PublicationWorkflowManager`:**
    *   –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (`filesToProcess`).
    *   **(–ù–æ–≤–æ–µ)** –í—ã–∑—ã–≤–∞–µ—Ç `initializeAndValidateCaches`, –∫–æ—Ç–æ—Ä—ã–π "–ø—Ä–æ–≥—Ä–µ–≤–∞–µ—Ç" –∫—ç—à —è–∫–æ—Ä–µ–π –¥–ª—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤.
    *   –ó–∞–ø—É—Å–∫–∞–µ—Ç `LinkVerifier`, –∫–æ—Ç–æ—Ä—ã–π —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–∂–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –∫—ç—à —è–∫–æ—Ä–µ–π.
    *   –ü–æ—Å–ª–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –≤—ã–∑—ã–≤–∞–µ—Ç `publisher.publishWithMetadata` –∏–ª–∏ `editWithMetadata`.
4.  **`EnhancedTelegraphPublisher`:**
    *   –í—ã—á–∏—Å–ª—è–µ—Ç `contentHash` –¥–ª—è —Ñ–∞–π–ª–∞.
    *   –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å —Ö—ç—à–µ–º –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –µ—Å—Ç—å). –ï—Å–ª–∏ —Ö—ç—à–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç –∏ `force` —Ñ–ª–∞–≥ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏—é.
    *   –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
        *   –û–±–Ω–æ–≤–ª—è–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ `.md` —Ñ–∞–π–ª–µ, –≤–∫–ª—é—á–∞—è –Ω–æ–≤—ã–π `contentHash`.
        *   –û–±–Ω–æ–≤–ª—è–µ—Ç `PagesCacheManager`, –¥–æ–±–∞–≤–ª—è—è –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è—è –∑–∞–ø–∏—Å—å –æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –≤–∫–ª—é—á–∞—è `contentHash`.
5.  **`PagesCacheManager` –∏ `AnchorCacheManager`:**
    *   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Å–≤–æ–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ `.json` —Ñ–∞–π–ª—ã.

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

*   ‚úÖ –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ `publish --author "–ù–æ–≤–æ–µ –ò–º—è"` —Ñ–∞–π–ª `.telegraph-publisher-config.json` —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –∏ –ø–æ–ª–µ `defaultUsername` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ "–ù–æ–≤–æ–µ –ò–º—è".
*   ‚úÖ –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ `publish` –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —Ñ–∞–π–ª—ã `.telegraph-anchors-cache.json` –∏ `.telegraph-pages-cache.json` —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –µ—Å–ª–∏ –æ–Ω–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏.
*   ‚úÖ –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—É—Å–∫–µ `publish` –¥–ª—è —Ñ–∞–π–ª–∞ —Å –Ω–µ–∏–∑–º–µ–Ω–µ–Ω–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º, `EnhancedTelegraphPublisher` –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ç–µ–≤–æ–π –≤—ã–∑–æ–≤ (—Å–æ–æ–±—â–µ–Ω–∏–µ "Content unchanged").
*   ‚úÖ –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `.md` —Ñ–∞–π–ª–∞ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ `publish`, `EnhancedTelegraphPublisher` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–µ—Ç–µ–≤–æ–π –≤—ã–∑–æ–≤ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
*   ‚úÖ –ü–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏, `contentHash` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–∞–∫ –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö `.md` —Ñ–∞–π–ª–∞, —Ç–∞–∫ –∏ –≤ –∑–∞–ø–∏—Å–∏ `.telegraph-pages-cache.json` –¥–ª—è —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞. 