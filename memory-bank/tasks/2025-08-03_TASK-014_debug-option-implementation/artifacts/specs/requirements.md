# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø—Ü–∏–∏ `--debug` –¥–ª—è –≤—ã–≤–æ–¥–∞ JSON

*   **ID –ó–∞–¥–∞—á–∏:** `TASK-014`
*   **–°—Ç–∞—Ç—É—Å:** `To Do`
*   **–î–∞—Ç–∞:** `2025-08-03`

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**
–í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –æ–ø—Ü–∏—è `--dry-run` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é, –Ω–æ –Ω–µ –¥–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Ç–æ–≥–æ–≤—ã–π JSON-–æ–±—ä–µ–∫—Ç (–º–∞—Å—Å–∏–≤ `TelegraphNode`), –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ API Telegra.ph. –≠—Ç–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç –æ—Ç–ª–∞–¥–∫—É –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ Markdown –≤ Telegraph Nodes.

**–¶–µ–ª—å:**
–í–≤–µ—Å—Ç–∏ –Ω–æ–≤—É—é CLI-–æ–ø—Ü–∏—é `--debug`, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ø–∞—Ä–µ —Å `--dry-run`. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ–π –æ–ø—Ü–∏–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON-–º–∞—Å—Å–∏–≤ –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ —Ñ–∞–π–ª, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ª–µ–≥–∫–æ –∏–Ω—Å–ø–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏.

## 2. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

1.  **–ù–æ–≤–∞—è CLI-–æ–ø—Ü–∏—è:**
    *   –î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ü–∏—é `--debug` –≤ –∫–æ–º–∞–Ω–¥—É `publish` (–∞–ª–∏–∞—Å `pub`).
    *   –û–ø–∏—Å–∞–Ω–∏–µ –æ–ø—Ü–∏–∏: "Save the generated Telegraph JSON to a file (implies --dry-run)".

2.  **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ `--dry-run`:**
    *   –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–ª–∞–≥ `--debug`, —Ñ–ª–∞–≥ `--dry-run` –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—á–∏—Ç–∞—Ç—å—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –Ω–µ –±—ã–ª —É–∫–∞–∑–∞–Ω —è–≤–Ω–æ. –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç —Ä–µ–∞–ª—å–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è.

3.  **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ JSON-—Ñ–∞–π–ª–∞:**
    *   –ü—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –æ–ø—Ü–∏–∏ `--debug` –∏—Ç–æ–≥–æ–≤—ã–π –º–∞—Å—Å–∏–≤ `TelegraphNode[]` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª.
    *   –§–∞–π–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å –∫—Ä–∞—Å–∏–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º (–æ—Ç—Å—Ç—É–ø—ã –≤ 2 –ø—Ä–æ–±–µ–ª–∞).
    *   –ò–º—è —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∏–º–µ–Ω–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ Markdown-—Ñ–∞–π–ª–∞, –Ω–æ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.json` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è `article.md` —Ñ–∞–π–ª –±—É–¥–µ—Ç –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è `article.json`).
    *   –§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, —á—Ç–æ –∏ –∏—Å—Ö–æ–¥–Ω—ã–π Markdown-—Ñ–∞–π–ª.

4.  **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–∏–¥–±–µ–∫:**
    *   –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –≤ –∫–æ–Ω—Å–æ–ª—å –¥–æ–ª–∂–Ω–æ –≤—ã–≤–æ–¥–∏—Ç—å—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä: `üíæ Debug JSON saved to: /path/to/article.json`.

## 3. –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –®–∞–≥ 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ CLI-–∫–æ–º–∞–Ω–¥—ã

**–ó–∞—Ç—Ä–∞–≥–∏–≤–∞–µ–º—ã–π —Ñ–∞–π–ª:** `src/cli/EnhancedCommands.ts`

–í –º–µ—Ç–æ–¥–µ `addPublishCommand` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –æ–ø—Ü–∏—é:

```typescript
// ... –≤ .command("publish")
.option("--debug", "Save the generated Telegraph JSON to a file (implies --dry-run)")
// ...
```

### –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã

**–ó–∞—Ç—Ä–∞–≥–∏–≤–∞–µ–º—ã–π —Ñ–∞–π–ª:** `src/workflow/PublicationWorkflowManager.ts`

–í –º–µ—Ç–æ–¥–µ `publish` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è `dryRun` –∏ –ø–µ—Ä–µ–¥–∞—á–∏ –æ–ø—Ü–∏–∏ `debug` –¥–∞–ª—å—à–µ –ø–æ —Ü–µ–ø–æ—á–∫–µ.

```typescript
// –í–Ω—É—Ç—Ä–∏ –º–µ—Ç–æ–¥–∞ publish(targetPath: string, options: any)
public async publish(targetPath: string, options: any): Promise<void> {
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ–º dry-run, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω debug
    if (options.debug) {
        options.dryRun = true;
    }

    // ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –º–µ—Ç–æ–¥–∞ ...

    // –ü—Ä–∏ –≤—ã–∑–æ–≤–µ publisher.publishWithMetadata –ø–µ—Ä–µ–¥–∞–µ–º –≤—Å–µ –æ–ø—Ü–∏–∏, –≤–∫–ª—é—á–∞—è debug
    for (const file of filesToProcess) {
      ProgressIndicator.showStatus(`‚öôÔ∏è Publishing: ${file}`, "info");
      const result = await this.publisher.publishWithMetadata(file, this.config.defaultUsername, {
        withDependencies: options.withDependencies !== false,
        forceRepublish: options.forceRepublish || false,
        dryRun: options.dryRun || false,
        debug: options.debug || false // <--- –ü–µ—Ä–µ–¥–∞–µ–º –æ–ø—Ü–∏—é debug
      });
      // ...
    }
}
```

### –®–∞–≥ 3: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è JSON

**–ó–∞—Ç—Ä–∞–≥–∏–≤–∞–µ–º—ã–π —Ñ–∞–π–ª:** `src/publisher/EnhancedTelegraphPublisher.ts`

–í –º–µ—Ç–æ–¥–µ `publishWithMetadata` –∏ `editWithMetadata` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è JSON-—Ñ–∞–π–ª–∞, –∫–æ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω—ã –æ–ø—Ü–∏–∏ `debug` –∏ `dryRun`.

**–ù–æ–≤—ã–π `import` –≤–≤–µ—Ä—Ö—É —Ñ–∞–π–ª–∞:**
```typescript
import { resolve } from "node:path";
```

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ `publishWithMetadata`:**
```typescript
// –í–Ω—É—Ç—Ä–∏ –º–µ—Ç–æ–¥–∞ publishWithMetadata
async publishWithMetadata(
    filePath: string,
    username: string,
    options: {
      withDependencies?: boolean;
      forceRepublish?: boolean;
      dryRun?: boolean;
      debug?: boolean; // <--- –î–æ–±–∞–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä
    } = {}
  ): Promise<PublicationResult> {
    try {
      const { withDependencies = true, forceRepublish = false, dryRun = false, debug = false } = options;
      // ... (—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–≥–∏–∫–∞ –¥–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ telegraphNodes)

      // ... –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ telegraphNodes ...
      const telegraphNodes = convertMarkdownToTelegraphNodes(contentForPublication);

      // –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è --debug
      if (debug && dryRun) {
        const jsonOutputPath = resolve(filePath.replace(/\.md$/, ".json"));
        try {
          writeFileSync(jsonOutputPath, JSON.stringify(telegraphNodes, null, 2), 'utf-8');
          ProgressIndicator.showStatus(`üíæ Debug JSON saved to: ${jsonOutputPath}`, 'info');
        } catch (error) {
          ProgressIndicator.showStatus(`‚ùå Failed to save debug JSON: ${error instanceof Error ? error.message : String(error)}`, 'error');
        }
      }

      if (dryRun) {
        // ... (–æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ dryRun)
      }

      // ... (–æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏)
    } catch (error) {
      // ...
    }
}
```
**–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω—É–∂–Ω–æ –≤–Ω–µ—Å—Ç–∏ –≤ –º–µ—Ç–æ–¥ `editWithMetadata`.**

## 4. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

1.  –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–º–∞–Ω–¥—ã `pub` —Å —Ñ–ª–∞–≥–æ–º `--debug` –ø—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–∞ Telegra.ph **–Ω–µ** –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.
2.  –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å —Ñ–ª–∞–≥–æ–º `--debug` —Ä—è–¥–æ–º —Å –∏—Å—Ö–æ–¥–Ω—ã–º —Ñ–∞–π–ª–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `article.md`) —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ñ–∞–π–ª —Å —Ç–µ–º –∂–µ –∏–º–µ–Ω–µ–º –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.json` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `article.json`).
3.  –°–æ–¥–µ—Ä–∂–∏–º–æ–µ `.json` —Ñ–∞–π–ª–∞ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–º JSON –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–∞—Å—Å–∏–≤ `TelegraphNode[]`.
4.  JSON –≤ —Ñ–∞–π–ª–µ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω —Å –æ—Ç—Å—Ç—É–ø–æ–º –≤ 2 –ø—Ä–æ–±–µ–ª–∞.
5.  –í –∫–æ–Ω—Å–æ–ª—å –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ debug-—Ñ–∞–π–ª–∞.
6.  –ó–∞–ø—É—Å–∫ –∫–æ–º–∞–Ω–¥—ã —Å —Ñ–ª–∞–≥–æ–º `--dry-run`, –Ω–æ **–±–µ–∑** `--debug`, **–Ω–µ** —Å–æ–∑–¥–∞–µ—Ç `.json` —Ñ–∞–π–ª.
7.  –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, —Ç–∞–∫ –∏ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–≤–æ–π `.json` —Ñ–∞–π–ª).

## 5. –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

**–ó–∞—Ç—Ä–∞–≥–∏–≤–∞–µ–º—ã–π —Ñ–∞–π–ª:** `src/workflow/PublicationWorkflowManager.test.ts`

**–ù–æ–≤—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**

1.  **–¢–µ—Å—Ç –¥–ª—è `--debug`:**
    *   –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π markdown-—Ñ–∞–π–ª.
    *   –í—ã–∑–≤–∞—Ç—å `workflowManager.publish` —Å –æ–ø—Ü–∏–µ–π `debug: true`.
    *   –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–µ—Ç–æ–¥ `publisher.publishWithMetadata` –±—ã–ª –≤—ã–∑–≤–∞–Ω —Å –æ–ø—Ü–∏—è–º–∏ `dryRun: true` –∏ `debug: true`.
    *   –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ä—è–¥–æ–º —Å —Ç–µ—Å—Ç–æ–≤—ã–º —Ñ–∞–π–ª–æ–º –±—ã–ª —Å–æ–∑–¥–∞–Ω `.json`-—Ñ–∞–π–ª.
    *   –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `.json`-—Ñ–∞–π–ª–∞ –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —ç—Ç–æ –≤–∞–ª–∏–¥–Ω—ã–π JSON.
    *   –£–¥–∞–ª–∏—Ç—å —Å–æ–∑–¥–∞–Ω–Ω—ã–π `.json`-—Ñ–∞–π–ª –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞.

2.  **–¢–µ—Å—Ç –¥–ª—è `--dry-run` –±–µ–∑ `--debug`:**
    *   –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π markdown-—Ñ–∞–π–ª.
    *   –í—ã–∑–≤–∞—Ç—å `workflowManager.publish` —Å –æ–ø—Ü–∏–µ–π `dryRun: true`, –Ω–æ `debug: false`.
    *   –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `.json`-—Ñ–∞–π–ª **–Ω–µ** –±—ã–ª —Å–æ–∑–¥–∞–Ω.

---

–≠—Ç–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É. –û–Ω–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —á–µ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —à–∞–≥–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.